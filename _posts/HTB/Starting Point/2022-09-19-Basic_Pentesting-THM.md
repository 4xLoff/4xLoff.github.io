---
layout:   post
title:    "Walkthrough Basic Pentesting."
subtitle: "Starting-Point"
category:   THM
tags:      [Easy, Linux, SMB, brute-forcing, Hydra, Enumeration, SSH, id_rsa, Default-Credentials, Walkthrough, Starting-Point]
---
![list](/assets/img/basic_pentesting/moMbBki.png){:.lead width="800" height="100" loading="lazy"}

***
<!--more-->

1. this ordered seed list will be replaced by the toc
{:toc}

***

## Reconocimiento

Fase inicial donde recolectamos toda la información posible del objetivo, utilizando 

diferentes técnicas como:

| Caracter.                                   |
|:--------------------------------------------|
|Recopilación de tecnologuias.                |
|Dominios.                                    |
|IPs.                                         |
|Puertos.                                     |
|Servicios.                                   |
|Recopilación de metadatos, etc.              |


***
### nmap

Utizando nmap comprobamos que puertos estan abiertos.


```bash
nmap --open -p- -Pn -n -vvv --min-rate 5000 -sS 10.10.202.116 -oG allports
```
El paso anterior se debe hacer con privileguios (root).
{:.note title="Attention"}

***
### Servicios y versiones

Una vez sabemos que puertos estan abiertos con el comando anterior podremos saber que 

versiones y servicios que corren en los mismo de ahi podremos determinara posibles 

vulnerabilidades.

Esto lo hacemos con el siguiente comando.


```bash
nmap -sCV -p22,80,139,445,8009,8080 10.10.202.116 -oN target -Pn
```
El paso anterior no es nesesario ser (root).
{:.note title="Attention"}

![list](/assets/img/basic_pentesting/Kali-2022-09-18-17-48-43.png){:.lead width="800" height="100" loading="lazy"}

***
### Investigación

Uso de Investigacion web, Google Hacking,Google Dorks.

Recopilación de información gracias a servicios de terceros.

Investigamos el servicio http que corre en el pueto 80 ,vemos que podemos loogearnos ,haciendo 

pass-desing, no logramos nada y aunque nos de unas credenciales legibles depues de cancelar no 

son validas son: user `tomcat` password `s3cret`.

![list](/assets/img/basic_pentesting/Kali-2022-09-18-17-50-58.png){:.lead width="800" height="100" loading="lazy"}

Hacemos ctrl + u para ispeccionar la pagina, econtrandonos con una pista.
{:.note}

Fuzzeamos la direccion IP para enumerar posibles direcctorios y nos encontramos el directorio `/development/`.

```bash
gobuster dir -u http://10.10.202.116 -w /usr/share/seclists/Discovery/Web-Content/raft-medium-directories.txt -t 100
```
![list](/assets/img/basic_pentesting/Kali-2022-09-18-17-52-25.png){:.lead width="800" height="100" loading="lazy"}

Si nos movemos a esa ruta en el navegador nos encontramos dos archivos uno con la version y 

otra que nos detalla que las pass es facil de crackear.

![list](/assets/img/basic_pentesting/Kali-2022-09-18-17-56-00.png){:.lead width="800" height="100" loading="lazy"}

El archivo dev.txt contiene la version.
{:.note}

![list](/assets/img/basic_pentesting/Kali-2022-09-18-17-56-05.png){:.lead width="800" height="100" loading="lazy"}

El archivo j.txt nos dice que facilmente crakeable.
{:.note}


## Analisis de vulnerabilidades

Con cracmapecxec verificamos si el smb esta firmado y nos arroja alguna informacion,con 

smbclient enumeramos los shares, por lo que se ve hay dos y presumiblemente el que dice 

anonymous se pueda entrar como ese usuario, ademas si agregamos el parametro -R podemos 

ver el recurso de forma recursiva encontratdonos un archivo `staff.txt`.

![list](/assets/img/basic_pentesting/Kali-2022-09-18-18-04-12.png){:.lead width="800" height="100" loading="lazy"}

{:.note title="Attention"}
El archivo staff solo contiene una conversacion ente jan y kay que tambien aparecen esa 

siglas en los archivos.txt anteriores por lo que deducimos que son usuarios del sistema a 

esta conclusion tambien podemos llegar si usamos la herramienta enum4linux.

```bash
enum4linux -a {IP}
```

***
## Explotacion

Con los usuarios enumerados podemos probar utilizar Hydra pa crackear las contraseñas con 

el siguiente comando.

```bash
hydra -l jan -P /usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt ssh://10.10.202.116
```

![list](/assets/img/basic_pentesting/Kali-2022-09-18-20-30-56.png){:.lead width="800" height="100" loading="lazy"}

Podriamos probar lo mismo para kay pero jan es vulnerable.
{:.note}

La pass es `armando` por lo caul nos conectamos por ssh, dentro de la maquina nos movemos

buscando las flags o archivos de interes no encontramos con un `pass.bak` que es simplemente

la backup de la pass pero a la cual no tenemos permisos de lectura por lo que siempre es 

bueno ejecutar `LimEnum` Y `pspy` para monitorizar y ver los posibles vectores para escalar 

de privilegios.

## Escalacion de privilegios 

LimEnum dice que en la carpeta oculta .ssh hay claves privadas expuestas por lo cual las 

copiaremos a la maquina atacante y trataremos de crackearlas.

```bash
scp jan@10.10.120.64:/home/kay/.ssh/id_rsa .
```

{:.note}
Podriamos simplemete copiar y pegar pero a veces si ho hay una sell interactiva en la victima 

se puede coromper la copia, se puede hacer de cualquier forma...


Le damos permisos `chmod 600 id_rsa` y ssh2john pasamos la id_rsa a texto plano para a 

posterion con john crackearla.

```bash
ssh2john id_rsa > id_rsa.txt
```

```bash
john -w=/usr/share/seclists/Passwords/Leaked-Databases/rockyou.txt id_rsa.txt
```
Luego nos conectamos por ssh y colocamos la contraseña que es `beeswax`.

```bash
ssh kay@10.10.202.116 -i id_rsa
```
![list](/assets/img/basic_pentesting/Kali-2022-09-18-21-12-41.png){:.lead width="800" height="100" loading="lazy"}


Nos va apedir la contraseña debmos pegar `beeswax`.
{:.note}

Ya lo ultimo sera localizar el archivo al que antes no teniamos permisos `cat pass.bak`.

![list](/assets/img/basic_pentesting/Kali-2022-09-18-21-17-45.png){:.lead width="800" height="100" loading="lazy"}


```bash
heresareallystrongpasswordthatfollowsthepasswordpolicy$$
```
***
```bash
🎉 Felicitaciones ya has comprometido Basic Pentesting de Try Hack Me 🎉
```
{:.centered}
***
